<!DOCTYPE html>
<html class="h-100" lang="en">
<head>
  <meta charset="utf-8">
  <meta content="width=device-width,initial-scale=1,shrink-to-fit=no" name="viewport">
  <meta content="Kelvin Ng - PP434 Data Science Project" name="description">

  <link href="img/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
  <link href="img/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
  <link href="img/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">

  <title>PP434 Data Science Project</title>

  <!-- Theme (matches index / portfolio) -->
  <link href="css/min/theme.css" rel="stylesheet">
  <link href="css/aos.css" rel="stylesheet">

  <!-- Vega-Lite -->
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>

  <style>
    /* Fonts (match index.html / portfolio.html) */
    @font-face {
      font-family: 'Inter';
      font-style: normal;
      font-weight: 300;
      font-display: swap;
      src: local(''),
          url('./fonts/inter-v12-latin-300.woff2') format('woff2'),
          url('./fonts/inter-v12-latin-300.woff') format('woff');
    }
    @font-face {
      font-family: 'Inter';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: local(''),
          url('./fonts/inter-v12-latin-500.woff2') format('woff2'),
          url('./fonts/inter-v12-latin-500.woff') format('woff');
    }
    @font-face {
      font-family: 'Inter';
      font-style: normal;
      font-weight: 700;
      font-display: swap;
      src: local(''),
          url('./fonts/inter-v12-latin-700.woff2') format('woff2'),
          url('./fonts/inter-v12-latin-700.woff') format('woff');
    }

    body {
      font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, Arial, sans-serif;
    }

    /* Hide scrollbars (keep scrolling) */
    html, body, .container-fluid, .row, main, .py-vh-3, .page-hero {
      scrollbar-width: none;
      -ms-overflow-style: none;
      overflow-x: clip;
    }
    html::-webkit-scrollbar,
    body::-webkit-scrollbar,
    .container-fluid::-webkit-scrollbar,
    .row::-webkit-scrollbar,
    main::-webkit-scrollbar,
    .py-vh-3::-webkit-scrollbar,
    .page-hero::-webkit-scrollbar {
      width: 0;
      height: 0;
    }

    /* Cards + separators */
    .page-hero { background: #f8f9fa; }
    .card-soft {
      background: #f8f9fa;
      border-radius: 16px;
    }
    .card-soft-inner {
      background: #ffffff;
      border-radius: 12px;
    }
    .section-sep {
      height: 1px;
      background: rgba(0,0,0,0.06);
      margin: 1.25rem 0;
    }

    /* Jump-to pills */
    .pill-row {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: .5rem;
      overflow: hidden;
      height: auto;
      max-height: none;
      white-space: normal;
      padding-bottom: 0;
      padding-top: 2px;
    }
    .pill-row::-webkit-scrollbar { width: 0; height: 0; }
    .pill-row { scrollbar-width: none; }
    .pill-row a {
      display: inline-block;
      margin: 0;
      padding: .4rem .75rem;
      border-radius: 999px;
      background: #fff;
      color: rgba(0,0,0,0.7);
      text-decoration: none;
      box-shadow: 0 1px 0 rgba(0,0,0,0.05);
      transition: transform .15s ease, color .15s ease;
    }
    .pill-row a:hover { color: rgba(0,0,0,0.95); transform: translateY(-1px); }

    /* Section header layout */
    .sec-headrow {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
      gap: .75rem;
    }
    .sec-header {
      display: flex;
      align-items: center;
      gap: 1rem;
    }
    .sec-badge {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      height: 28px;
      padding: 0 12px;
      border-radius: 999px;
      background: #111;
      color: #fff;
      font-weight: 700;
      font-size: .75rem;
      line-height: 1;
      letter-spacing: .02em;
      transform: translateY(-1px);
      white-space: nowrap;
    }
    .sec-badge a {
      color: #fff;
      text-decoration: none;
    }
    .sec-badge a:hover {
      color: #fff;
      text-decoration: underline;
    }
    .sec-title {
      font-size: 1.35rem;
      line-height: 1.15;
      font-weight: 700;
      margin: 0;
    }

    /* Note box text */
    .note-text {
      font-size: 0.95rem;
      line-height: 1.65;
      color: rgba(0,0,0,0.8);
    }

    /* Chart label row */
    .chart-label-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.75rem;
      flex-wrap: wrap;
      margin-bottom: 0.5rem;
    }
    .chart-label {
      font-size: 0.875rem;
      color: rgba(0,0,0,0.6);
    }
    .colab-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      height: 24px;
      padding: 0 10px;
      border-radius: 999px;
      background: #111;
      color: #fff;
      font-weight: 600;
      font-size: .7rem;
      line-height: 1;
      letter-spacing: .02em;
      text-decoration: none;
      transition: background 0.15s ease;
    }
    .colab-btn:hover {
      background: #333;
      color: #fff;
      text-decoration: none;
    }

    /* Chart slots */
    .chart-slot { min-width: 0; }
    .chart-slot .vega-embed { width: 100%; }

    .chart-slot {
      min-height: 400px;
      height: 400px;
      background: #ffffff;
      border-radius: 12px;
      box-shadow: 0 1px 0 rgba(0,0,0,0.05);
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      width: 100%;
      position: relative;
    }

    .chart-slot.compact {
      min-height: 320px;
      height: 320px;
    }

    .chart-slot.empty {
      border: 1px dashed rgba(0,0,0,0.18);
      color: rgba(0,0,0,0.45);
      box-shadow: none;
    }

    /* Two charts side-by-side */
    .chart-row {
      display: flex;
      gap: 1rem;
    }
    .chart-row .chart-slot {
      flex: 1;
      min-width: 0;
    }

    /* Small helper blocks */
    .meta-kv {
      display: grid;
      grid-template-columns: 1fr;
      gap: .5rem;
    }
    .meta-kv .rowline {
      display: grid;
      grid-template-columns: 110px 1fr;
      gap: .75rem;
      align-items: start;
    }
    .meta-kv .k {
      font-weight: 700;
      color: rgba(0,0,0,0.75);
    }
    .meta-kv .v {
      color: rgba(0,0,0,0.7);
    }

    /* Mobile */
    @media only screen and (max-width: 992px) {
      .chart-row { flex-direction: column; }
      .chart-row > div[style*="flex"] {
        flex: 1 1 100% !important;
        min-width: 100% !important;
      }
      .row.g-3 > .col-md-6,
      .row.g-3 > .col-md-4 {
        flex: 0 0 100%;
        max-width: 100%;
      }
    }

    @media only screen and (max-width: 768px) {
      .px-vw-5 { padding-left: 1rem !important; padding-right: 1rem !important; }
      .p-5 { padding: 1.5rem !important; }
      .navbar { padding-left: 0 !important; padding-right: 0 !important; }
      #navScroll .nav-link { padding: 0.25rem 0.5rem !important; font-size: 0.875rem; }
      h1 { font-size: 1.7rem !important; }
      .chart-slot { min-height: 240px; height: 240px; }
      .chart-slot.compact { min-height: 220px; height: 220px; }
      .sec-title { font-size: 1.2rem; }
      .meta-kv .rowline { grid-template-columns: 1fr; }
    }

    /* Error overlay (only shows if a chart JSON is missing) */
    .chart-error {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 1rem;
      text-align: center;
      color: rgba(0,0,0,0.55);
      background: rgba(255,255,255,0.9);
      border-radius: 12px;
      border: 1px dashed rgba(0,0,0,0.18);
    }
  </style>
</head>

<body class="position-relative d-flex h-100 w-100" data-bs-spy="scroll" data-bs-target="#navScroll">
  <div class="h-100 container-fluid position-relative">
    <div class="h-100 row d-flex align-items-stretch position-relative z-1">
      <div class="p-0 col-12 d-flex align-items-start flex-column">

        <!-- Header -->
        <header class="mb-auto py-vh-2 col-12 px-vw-5">
          <nav class="navbar navbar-expand-lg navbar-dark d-flex px-3" id="navScroll" tabindex="0">
            <a class="navbar-brand d-flex align-items-center flex-grow-1 link-opacity-50-hover link-dark" href="index.html">
              <div class="fw-bold fs-4">Kelvin Ng</div>
            </a>
            <div class="col-auto ps-2 ms-2">
              <ul class="nav ms-auto mb-2 mb-lg-0 ms-2 list-inline list-unstyled align-items-center">
                <li class="nav-item">
                  <a class="nav-link pe-3 link-dark link-opacity-50-hover" href="index.html">Home</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link pe-3 link-dark link-opacity-50-hover" href="portfolio.html">Portfolio</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link pe-3 link-dark" href="project.html"><span class="fw-bold">Project</span></a>
                </li>
                <li class="nav-item">
                  <a aria-label="GitHub" class="nav-link pe-2 link-dark link-opacity-50-hover" href="https://github.com/kelvinchwng" rel="noreferrer" target="_blank">
                    <svg fill="currentColor" height="20" viewBox="0 0 16 16" width="20" xmlns="http://www.w3.org/2000/svg">
                      <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
                    </svg>
                  </a>
                </li>
                <li class="nav-item">
                  <a aria-label="LinkedIn" class="nav-link link-dark link-opacity-50-hover" href="https://linkedin.com/in/kelvinchwng" rel="noreferrer" target="_blank">
                    <svg fill="currentColor" height="20" viewBox="0 0 16 16" width="20" xmlns="http://www.w3.org/2000/svg">
                      <path d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z"/>
                    </svg>
                  </a>
                </li>
              </ul>
            </div>
          </nav>
        </header>

        <!-- Main -->
        <main class="mb-auto col-12 px-vw-5">

          <!-- Hero -->
          <div class="page-hero rounded p-5" data-aos="fade-up">
            <h1 class="text-black mb-2"><strong>PP434 Data Science Project</strong></h1>
            <p class="lead text-muted mb-0">Migration, integration and the employment gap in Sweden</p>
            <p class="lead text-muted mb-0">Candidate Number 67247</p>
          </div>

          <div class="py-vh-3">

            <!-- 1. INTRODUCTION & AIMS -->
            <section class="card-soft rounded p-4 mb-5" data-aos="fade-up" id="intro">
              <div class="sec-headrow">
                <div class="sec-header">
                  <span class="sec-badge">1</span>
                  <h2 class="sec-title mb-0">Introduction &amp; aims</h2>
                </div>
                <a class="small link-dark link-opacity-50-hover" href="#navScroll">Back to top</a>
              </div>

              <div class="card-soft-inner p-3 mt-3">
                <p class="note-text mb-0">
                  Sweden's employment gap between native- and foreign-born residents is among the largest in the OECD, fuelling political narratives that <a href="https://www.nytimes.com/2025/03/28/opinion/sweden-migration-policy.html">immigration "doesn't work"</a>. This project investigates how much of that gap reflects <em>who</em> arrived (cohort composition, reason for migration) versus persistent structural barriers (skills transfer, discrimination, weak local labour markets). Using Swedish administrative data, I decompose integration outcomes by arrival cohort, residence category, and time since arrival, translating findings into policy-relevant conclusions about where intervention can realistically improve the situation.
                </p>
              </div>
            </section>

            <!-- 2. BACKGROUND (NOTE + 2 CHARTS) -->
            <section class="card-soft rounded p-4 mb-5" data-aos="fade-up" id="background">
              <div class="sec-headrow">
                <div class="sec-header">
                  <span class="sec-badge">2</span>
                  <h2 class="sec-title mb-0">Background</h2>
                </div>
                <a class="small link-dark link-opacity-50-hover" href="#navScroll">Back to top</a>
              </div>

              <div class="card-soft-inner p-3 mt-3">
                <p class="note-text mb-0">
                  Sweden's migration profile shifted dramatically through the 2010s: a large asylum inflow peaked in 2015–16, alongside continuing family reunification and economic migration. The Public Employment Service (<em>Arbetsförmedlingen</em>) runs the two-year Establishment Programme for newly arrived refugees, combining language training, civic orientation, and job-matching. Despite these efforts, official statistics show persistently lower employment rates among foreign-born residents, especially non-EU migrants when compared to natives. The issue is then not "migration: good or bad?" but rather which mechanisms sustain the gap and where targeted reform (credential recognition, employer incentives, activation design) can make a difference.
                </p>
              </div>

              <div class="chart-row mt-3">
                <div style="flex: 1; min-width: 0;">
                  <div class="chart-label-row">
                    <span class="chart-label"><strong>Chart 1.</strong> Immigration to Sweden by category (2000–2023)</span>
                    <a class="colab-btn" href="https://colab.research.google.com/drive/1rKfOAtzZ2Ehl9gAoK6gGIr0-IqM7_M9d?usp=sharing" target="_blank">Colab Notebook</a>
                  </div>
                  <div class="chart-slot" id="proj-chart1"></div>
                </div>
                <div style="flex: 1; min-width: 0;">
                  <div class="chart-label-row">
                    <span class="chart-label"><strong>Chart 2.</strong> Employment rate: Swedish-born vs foreign-born (2006–2023)</span>
                    <a class="colab-btn" href="https://colab.research.google.com/drive/1gp2YNZy3EE9LhUlXePQagoCJFRp1tOKL?usp=sharing" target="_blank">Colab Notebook</a>
                  </div>
                  <div class="chart-slot" id="proj-chart2"></div>
                </div>
              </div>
            </section>

            <!-- 3. FINDINGS (NOTE + 2 CHARTS, NOTE + 2 CHARTS) -->
            <section class="card-soft rounded p-4 mb-5" data-aos="fade-up" id="findings">
              <div class="sec-headrow">
                <div class="sec-header">
                  <span class="sec-badge">3</span>
                  <h2 class="sec-title mb-0">Findings</h2>
                </div>
                <a class="small link-dark link-opacity-50-hover" href="#navScroll">Back to top</a>
              </div>

              <!-- Lens 1: Integration outcomes -->
              <div class="card-soft-inner p-3 mt-3">
                <p class="note-text mb-0">
                  <strong>Time-to-employment and cohort composition.</strong> Employment outcomes improve markedly with time since arrival, but convergence speed varies by category. Refugees and family migrants start from low employment rates (~30–40%) but show steady gains; after 10+ years, refugees approach 70%. Labour migrants, by contrast, arrive with near-native employment but show limited further convergence. These patterns suggest the gap is partly due to structural factors, years with large refugee inflows mechanically lower the aggregate foreign-born employment rate. The implication is that fast and early attachment to work (workplace-linked language training, accelerated credential validation, employer matching) can compress integration timelines, particularly for groups that start furthest behind since the refugee crisis.
                </p>
              </div>

              <div class="chart-row mt-3">
                <div style="flex: 1; min-width: 0;">
                  <div class="chart-label-row">
                    <span class="chart-label"><strong>Chart 3.</strong> Employment rate by residence category and years since arrival</span>
                    <a class="colab-btn" href="https://colab.research.google.com/drive/1_EI7K0BLACpdrG9EbHnCQHVULYm_1EWu?usp=sharing" target="_blank">Colab Notebook</a>
                  </div>
                  <div class="chart-slot" id="proj-chart3"></div>
                </div>
                <div style="flex: 1; min-width: 0;">
                  <div class="chart-label-row">
                    <span class="chart-label"><strong>Chart 4.</strong> Employment gap by country/region of origin</span>
                    <a class="colab-btn" href="https://colab.research.google.com/drive/1aOdaj4A2lPMhwmatyV87iXRsk75SlIZT?usp=sharing" target="_blank">Colab Notebook</a>
                  </div>
                  <div class="chart-slot" id="proj-chart4"></div>
                </div>
              </div>

              <!-- Lens 2: Fiscal and macro stakes -->
              <div class="card-soft-inner p-3 mt-3">
                <p class="note-text mb-0">
                  <strong>Fiscal contribution and the macro stakes.</strong> Public debate often frames immigration through a fiscal lens—whether migrants "pay their way". Cross-country evidence however, shows that Sweden's net fiscal position for immigrants improved substantially between 2005 and 2022, converging toward the EU average as employment rates rose. Longitudinal Swedish data reinforces this, as refugee employment grows roughly 11-fold over 26 years of residence (R² = 0.94), translating directly into tax contributions and reduced transfer dependency. <a href="https://www.riksbank.se/en-gb/press-and-published/publications/economic-commentaries/labour-market-matching-in-sweden/other-indicators-give-a-mixed-picture-of-matching-efficiency/sharp-increase-in-employment-rate-among-foreign-born-persons-suggests-improved-matching-efficiency-since-the-pandemic/">The Riksbank notes that post-pandemic foreign-born employment gains have been notable.</a> The policy lever is clear: because taxes and transfers both scale with labour-market attachment, even modest employment-rate improvements yield large fiscal dividends over time.
                </p>
              </div>

              <div class="chart-row mt-3">
                <div style="flex: 1; min-width: 0;">
                  <div class="chart-label-row">
                    <span class="chart-label"><strong>Chart 5.</strong> Net fiscal contribution of immigrants: EU comparison (2005 vs 2022)</span>
                    <a class="colab-btn" href="https://colab.research.google.com/drive/1frsiGs-igLsAszneaIWv6YCYMcgOrSQM?usp=sharing" target="_blank">Colab Notebook</a>
                  </div>
                  <div class="chart-slot" id="proj-chart5"></div>
                </div>
                <div style="flex: 1; min-width: 0;">
                  <div class="chart-label-row">
                    <span class="chart-label"><strong>Chart 6.</strong> Refugee employment trajectory: regression analysis</span>
                    <a class="colab-btn" href="https://colab.research.google.com/drive/1Lugefh-DSczhi_0DXzPUV4ZeLcLXGtyJ?usp=sharing" target="_blank">Colab Notebook</a>
                  </div>
                  <div class="chart-slot" id="proj-chart6"></div>
                </div>
              </div>
            </section>

            <!-- 4. DATA SOURCES & TOOLS (NOTE ONLY) -->
            <section class="card-soft rounded p-4 mb-5" data-aos="fade-up" id="data-tools">
              <div class="sec-headrow">
                <div class="sec-header">
                  <span class="sec-badge">4</span>
                  <h2 class="sec-title mb-0">Data sources &amp; tools</h2>
                </div>
                <a class="small link-dark link-opacity-50-hover" href="#navScroll">Back to top</a>
              </div>

              <div class="card-soft-inner p-3 mt-3">
                <p class="note-text mb-2">
                  The primary data source is Statistics Sweden (SCB), accessed via their <em>Statistikdatabasen</em> interface. Unlike many national statistics offices, SCB does not offer a straightforward public API for bulk downloads; data must be manually configured through their web interface and exported as CSV or Excel. This created workflow friction, as each table (migration flows, employment by residence category, cohort-tracked refugee employment) required separate downloads with careful attention to Swedish-language column headers and date formats.
                </p>
                <p class="note-text mb-2">
                  <strong>Encoding challenges.</strong> Swedish administrative data uses Latin-1 (ISO-8859-1) encoding with special characters (å, ä, ö) that break standard UTF-8 parsers. Early attempts to scrape OECD PDF reports programmatically failed: tables extracted as malformed strings, row boundaries were lost, and numeric columns merged unpredictably. Rather than interpolate or guess, I switched to manual CSV exports from SCB and hand-verified the OECD fiscal-contribution data against the original PDF. The portfolio challenges (CC5–CC7) built up the skills needed to handle these issues systematically: web scraping, API batch downloads with loops, and tidy-data reshaping.
                </p>
                <p class="note-text mb-2">
                  All processing was done in Google Colab, with cleaned JSON exported to GitHub for Vega-Lite visualisation. Additional context came from the Swedish Migration Agency (<em>Migrationsverket</em>) for permit categories, OECD fiscal-contribution estimates for the EU cross-country comparison, and Riksbank/NIER publications for macro framing.
                </p>
                <div class="section-sep"></div>
                <div class="note-text text-muted">
                  <strong>Sources:</strong>
                  <a class="link-dark" href="https://www.statistikdatabasen.scb.se/" target="_blank" rel="noreferrer">SCB Statistikdatabasen</a> ·
                  <a class="link-dark" href="https://www.migrationsverket.se/English/About-the-Migration-Agency/Statistics.html" target="_blank" rel="noreferrer">Migrationsverket</a> ·
                  <a class="link-dark" href="https://www.oecd.org/migration/" target="_blank" rel="noreferrer">OECD Migration</a>                 </div>
              </div>
            </section>

            <!-- 5. CONCLUSION (NOTE ONLY) -->
            <section class="card-soft rounded p-4 mb-5" data-aos="fade-up" id="conclusion">
              <div class="sec-headrow">
                <div class="sec-header">
                  <span class="sec-badge">5</span>
                  <h2 class="sec-title mb-0">Conclusion</h2>
                </div>
                <a class="small link-dark link-opacity-50-hover" href="#navScroll">Back to top</a>
              </div>

              <div class="card-soft-inner p-3 mt-3">
                <p class="note-text mb-0">
                  Sweden's employment gap is real but not immutable. Part reflects structural factors (depending on which cohort), but refugee inflows take time to integrate. Policy can address these structural barriers, as the evidence points employment as a clear way of solving it. Each year of labour-market attachment drives convergence in both employment rates and fiscal contribution. Effective reform means compressing the integration timeline through faster credential recognition, employer-facing incentives, and workplace-linked language training—while targeting resources where gaps persist longest. If employment gaps narrow, the political and fiscal narratives that currently dominate debate become less salient.
                </p>
              </div>
            </section>

          </div>
        </main>

        <!-- Footer -->
        <footer class="mt-auto col-12 py-vh-3 px-vw-5">
          <div class="row d-flex justify-content-between small">
            <div class="col-12 col-md-auto d-flex justify-content-center">
              <ul class="nav bg-light rounded px-3 align-items-center">
                <li class="nav-item">
                  <a class="nav-link link-dark px-0" href="index.html" aria-label="Go home!">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-house-fill" viewBox="0 0 16 16">
                      <path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L8 2.207l6.646 6.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5Z"/>
                      <path d="m8 3.293 6 6V13.5a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 13.5V9.293l6-6Z"/>
                    </svg>
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link link-dark" href="portfolio.html">Portfolio</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link link-dark" href="project.html">Project</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link link-dark" href="https://github.com/kelvinchwng" target="_blank" rel="noreferrer" aria-label="GitHub">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                      <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
                    </svg>
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link link-dark" href="https://linkedin.com/in/kelvinchwng" target="_blank" rel="noreferrer" aria-label="LinkedIn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                      <path d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z"/>
                    </svg>
                  </a>
                </li>
              </ul>
            </div>
            <div class="col-12 col-md text-center text-md-end py-2">
              Made by <a href="https://templatedeck.com" class="link-fancy" target="_blank">templatedeck.com</a>
            </div>
          </div>
        </footer>

      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="js/bootstrap.bundle.min.js"></script>
  <script src="js/aos.js"></script>
  <script>
  window.addEventListener('load', () => {
    AOS.init({ });
    if (AOS && typeof AOS.refreshHard === 'function') {
      AOS.refreshHard();
    } else if (AOS && typeof AOS.refresh === 'function') {
      AOS.refresh();
    }

    const EMBED_OPTS = { actions: false, renderer: "svg" };

    function showChartError(container, url, err) {
      if (!container) return;
      container.classList.add('empty');
      // avoid stacking overlays
      if (container.querySelector('.chart-error')) return;
      const overlay = document.createElement('div');
      overlay.className = 'chart-error';
      overlay.innerHTML = `
        <div>
          <div class="fw-bold mb-1">Chart placeholder</div>
          <div class="small">Could not load: <code>${url}</code></div>
          <div class="small text-muted mt-2">Check the JSON path/name, or that the file is committed to GitHub Pages.</div>
        </div>`;
      container.appendChild(overlay);
      if (err) console.error('Vega embed error for', url, err);
    }

    function embedChart(selector, url) {
      const el = document.querySelector(selector);
      return vegaEmbed(selector, url, EMBED_OPTS).then((res) => {
        const view = res.view;

        // Force resizes after layout settles (fonts/AOS/flex)
        requestAnimationFrame(() => { view.resize(); view.runAsync(); });
        setTimeout(() => { view.resize(); view.runAsync(); }, 120);
        setTimeout(() => { view.resize(); view.runAsync(); }, 450);

        // Keep it correct whenever the container size changes
        if (el && 'ResizeObserver' in window) {
          const ro = new ResizeObserver(() => {
            view.resize();
            view.runAsync();
          });
          ro.observe(el);
        }

        return res;
      }).catch((err) => {
        showChartError(el, url, err);
        return null; // don't break Promise.all
      });
    }

    Promise.all([
      embedChart('#proj-chart1', 'project/charts/p1.json'),
      embedChart('#proj-chart2', 'project/charts/p2.json'),
      embedChart('#proj-chart3', 'project/charts/p3.json'),
      embedChart('#proj-chart4', 'project/charts/p4.json'),
      embedChart('#proj-chart5', 'project/charts/p5.json'),
      embedChart('#proj-chart6', 'project/charts/p6.json')
    ]).then(() => {
      setTimeout(() => window.dispatchEvent(new Event('resize')), 250);
    });

  });
</script>
</body>
</html>